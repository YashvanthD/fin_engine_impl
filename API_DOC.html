<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TaskCircuit API Documentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #f8f9fa; color: #222; margin: 0; padding: 0; }
        .container { max-width: 900px; margin: 40px auto; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px #0001; padding: 32px; }
        h1, h2, h3 { color: #2a4d7c; }
        h1 { font-size: 2.2em; margin-bottom: 0.5em; }
        h2 { font-size: 1.5em; margin-top: 2em; }
        h3 { font-size: 1.2em; margin-top: 1.5em; }
        pre, code { background: #f4f4f4; border-radius: 4px; padding: 8px; font-size: 1em; }
        .endpoint { margin-bottom: 2em; }
        .fields { margin: 0.5em 0 1em 1em; }
        .curl { background: #eaf6ff; border-left: 4px solid #2a4d7c; padding: 8px; margin: 0.5em 0 1em 1em; }
        .section { border-bottom: 1px solid #eee; margin-bottom: 2em; padding-bottom: 2em; }
        .note { background: #fffbe6; border-left: 4px solid #ffd700; padding: 8px; margin: 1em 0; }
        @media (max-width: 600px) { .container { padding: 12px; } }
    </style>
</head>
<body>
<div class="container">
    <h1>TaskCircuit API Documentation</h1>
    <div class="note">
        <strong>Date:</strong> December 5, 2025<br>
        <strong>Base URL:</strong> <code>http://localhost:5000/</code><br>
        All endpoints use JSON. Authentication is via Bearer token in <code>Authorization</code> header where required.
    </div>
    <div class="section">
        <h2>Authentication</h2>
        <div class="endpoint">
            <h3>POST /auth/signup</h3>
            <div class="fields"><strong>Fields:</strong> master_password, company_name, username, password, email</div>
            <div class="curl"><pre>curl -X POST http://localhost:5000/auth/signup \
  -H "Content-Type: application/json" \
  -d '{ "master_password": "YOUR_MASTER_ADMIN_PASSWORD", "company_name": "TaskCircuit", "username": "adminuser", "password": "adminpassword", "email": "admin@example.com" }'</pre></div>
        </div>
        <div class="endpoint">
            <h3>POST /auth/login</h3>
            <div class="fields"><strong>Fields:</strong> username, password</div>
            <div class="curl"><pre>curl -X POST http://localhost:5000/auth/login \
  -H "Content-Type: application/json" \
  -d '{ "username": "adminuser", "password": "adminpassword" }'</pre></div>
        </div>
        <div class="endpoint">
            <h3>POST /auth/token</h3>
            <div class="fields"><strong>Fields:</strong> type ("refresh_token"), token (refresh_token)</div>
            <div class="curl"><pre>curl -X POST http://localhost:5000/auth/token \
  -H "Content-Type: application/json" \
  -d '{ "type": "refresh_token", "token": "REFRESH_TOKEN" }'</pre></div>
        </div>
        <div class="endpoint">
            <h3>GET /auth/validate</h3>
            <div class="fields"><strong>Fields:</strong> Authorization header (Bearer ACCESS_TOKEN or REFRESH_TOKEN)</div>
            <div class="curl"><pre>curl -X GET http://localhost:5000/auth/validate \
  -H "Authorization: Bearer ACCESS_TOKEN_OR_REFRESH_TOKEN"</pre></div>
        </div>
    </div>
    <div class="section">
        <h2>Company</h2>
        <div class="endpoint">
            <h3>POST /company/register</h3>
            <div class="fields"><strong>Fields:</strong> company_name, description, pincode, number_of_employees, owner_user_key, account_key</div>
            <div class="curl"><pre>curl -X POST http://localhost:5000/company/register \
  -H "Content-Type: application/json" \
  -d '{ ...company fields... }'</pre></div>
        </div>
        <div class="endpoint">
            <h3>PUT /company/update</h3>
            <div class="fields"><strong>Fields:</strong> Any updatable company field</div>
            <div class="curl"><pre>curl -X PUT http://localhost:5000/company/update \
  -H "Authorization: Bearer ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{ ...fields to update... }'</pre></div>
        </div>
        <div class="endpoint">
            <h3>GET /company/&lt;account_key&gt;</h3>
            <div class="fields"><strong>Fields Returned:</strong> company_name, created_date, owner_user_key, worker_count, account_key</div>
            <div class="curl"><pre>curl -X GET http://localhost:5000/company/&lt;account_key&gt;</pre></div>
        </div>
    </div>
    <div class="section">
        <h2>User</h2>
        <div class="endpoint">
            <h3>POST /auth/account/&lt;account_key&gt;/signup</h3>
            <div class="fields"><strong>Fields:</strong> username, password, email, role, account_key</div>
            <div class="curl"><pre>curl -X POST http://localhost:5000/auth/account/&lt;account_key&gt;/signup \
  -H "Authorization: Bearer ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{ ...user fields... }'</pre></div>
        </div>
        <div class="endpoint">
            <h3>GET /auth/account/users</h3>
            <div class="fields"><strong>Fields Returned:</strong> users: [user objects]</div>
            <div class="curl"><pre>curl -X GET http://localhost:5000/auth/account/users \
  -H "Authorization: Bearer ACCESS_TOKEN"</pre></div>
        </div>
        <div class="endpoint">
            <h3>GET /auth/account/&lt;account_key&gt;/user/&lt;user_key&gt;</h3>
            <div class="fields"><strong>Fields Returned:</strong> All user fields</div>
            <div class="curl"><pre>curl -X GET http://localhost:5000/auth/account/&lt;account_key&gt;/user/&lt;user_key&gt; \
  -H "Authorization: Bearer ACCESS_TOKEN"</pre></div>
        </div>
        <div class="endpoint">
            <h3>PUT /auth/account/&lt;account_key&gt;/user/&lt;user_key&gt;</h3>
            <div class="fields"><strong>Fields:</strong> Any updatable user field</div>
            <div class="curl"><pre>curl -X PUT http://localhost:5000/auth/account/&lt;account_key&gt;/user/&lt;user_key&gt; \
  -H "Authorization: Bearer ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{ ...fields... }'</pre></div>
        </div>
        <div class="endpoint">
            <h3>DELETE /auth/account/&lt;account_key&gt;/user/&lt;user_key&gt;</h3>
            <div class="curl"><pre>curl -X DELETE http://localhost:5000/auth/account/&lt;account_key&gt;/user/&lt;user_key&gt; \
  -H "Authorization: Bearer ACCESS_TOKEN"</pre></div>
        </div>
    </div>
    <div class="section">
        <h2>Tasks</h2>
        <div class="endpoint">
            <h3>POST /tasks/</h3>
            <div class="fields"><strong>Fields:</strong> title, description, assigned_to, due_date, status, account_key</div>
            <div class="curl"><pre>curl -X POST http://localhost:5000/tasks/ \
  -H "Authorization: Bearer ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{ "title": "Task 1", "assigned_to": "USER123", "account_key": "ACC123" }'</pre></div>
        </div>
        <div class="endpoint">
            <h3>GET /tasks/?account_key=xxx</h3>
            <div class="fields"><strong>Fields Returned:</strong> tasks: [task objects]</div>
            <div class="curl"><pre>curl -X GET "http://localhost:5000/tasks/?account_key=ACC123" \
  -H "Authorization: Bearer ACCESS_TOKEN"</pre></div>
        </div>
        <div class="endpoint">
            <h3>GET /tasks/&lt;task_id&gt;</h3>
            <div class="fields"><strong>Fields Returned:</strong> All task fields</div>
            <div class="curl"><pre>curl -X GET http://localhost:5000/tasks/&lt;task_id&gt; \
  -H "Authorization: Bearer ACCESS_TOKEN"</pre></div>
        </div>
        <div class="endpoint">
            <h3>PUT /tasks/&lt;task_id&gt;</h3>
            <div class="fields"><strong>Fields:</strong> Any updatable task field</div>
            <div class="curl"><pre>curl -X PUT http://localhost:5000/tasks/&lt;task_id&gt; \
  -H "Authorization: Bearer ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{ ...fields... }'</pre></div>
        </div>
        <div class="endpoint">
            <h3>DELETE /tasks/&lt;task_id&gt;</h3>
            <div class="curl"><pre>curl -X DELETE http://localhost:5000/tasks/&lt;task_id&gt; \
  -H "Authorization: Bearer ACCESS_TOKEN"</pre></div>
        </div>
    </div>
    <div class="section">
        <h2>Fish</h2>
        <div class="endpoint">
            <h3>POST /fish/</h3>
            <div class="fields"><strong>Fields:</strong> common_name, scientific_name, species_code, count, length, weight, account_key, [dynamic fields]</div>
            <div class="curl"><pre>curl -X POST http://localhost:5000/fish/ \
  -H "Content-Type: application/json" \
  -d '{ "common_name": "Catfish", "scientific_name": "Siluriformes", "species_code": "CF001", "count": 10, "length": 25.5, "weight": 2.3, "account_key": "ACC123" }'</pre></div>
        </div>
        <div class="endpoint">
            <h3>GET /fish/?account_key=xxx</h3>
            <div class="fields"><strong>Fields Returned:</strong> fish: [fish objects]</div>
            <div class="curl"><pre>curl -X GET "http://localhost:5000/fish/?account_key=ACC123"</pre></div>
        </div>
        <div class="endpoint">
            <h3>GET /fish/&lt;fish_id&gt;</h3>
            <div class="fields"><strong>Fields Returned:</strong> All fish fields</div>
            <div class="curl"><pre>curl -X GET http://localhost:5000/fish/&lt;fish_id&gt;</pre></div>
        </div>
        <div class="endpoint">
            <h3>PUT /fish/&lt;fish_id&gt;</h3>
            <div class="fields"><strong>Fields:</strong> Any updatable fish field</div>
            <div class="curl"><pre>curl -X PUT http://localhost:5000/fish/&lt;fish_id&gt; \
  -H "Content-Type: application/json" \
  -d '{ ...fields... }'</pre></div>
        </div>
        <div class="endpoint">
            <h3>DELETE /fish/&lt;fish_id&gt;</h3>
            <div class="curl"><pre>curl -X DELETE http://localhost:5000/fish/&lt;fish_id&gt;</pre></div>
        </div>
    </div>
    <div class="section">
        <h2>Pond</h2>
        <div class="endpoint">
            <h3>POST /pond/</h3>
            <div class="fields"><strong>Fields:</strong> pond_name, location, size, water_type, account_key, [dynamic fields]</div>
            <div class="curl"><pre>curl -X POST http://localhost:5000/pond/ \
  -H "Authorization: Bearer ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{ "pond_name": "Main Pond", "location": "Farm 1", "size": "Large", "water_type": "Freshwater", "account_key": "ACC123" }'</pre></div>
        </div>
        <div class="endpoint">
            <h3>GET /pond/?account_key=xxx</h3>
            <div class="fields"><strong>Fields Returned:</strong> ponds: [pond objects]</div>
            <div class="curl"><pre>curl -X GET "http://localhost:5000/pond/?account_key=ACC123" \
  -H "Authorization: Bearer ACCESS_TOKEN"</pre></div>
        </div>
        <div class="endpoint">
            <h3>GET /pond/&lt;pond_id&gt;</h3>
            <div class="fields"><strong>Fields Returned:</strong> pond (all fields), events (list), analytics (object)</div>
            <div class="curl"><pre>curl -X GET http://localhost:5000/pond/&lt;pond_id&gt; \
  -H "Authorization: Bearer ACCESS_TOKEN"</pre></div>
        </div>
        <div class="endpoint">
            <h3>PUT /pond/&lt;pond_id&gt;</h3>
            <div class="fields"><strong>Fields:</strong> Any updatable pond field</div>
            <div class="curl"><pre>curl -X PUT http://localhost:5000/pond/&lt;pond_id&gt; \
  -H "Authorization: Bearer ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{ ...fields... }'</pre></div>
        </div>
        <div class="endpoint">
            <h3>DELETE /pond/&lt;pond_id&gt;</h3>
            <div class="curl"><pre>curl -X DELETE http://localhost:5000/pond/&lt;pond_id&gt; \
  -H "Authorization: Bearer ACCESS_TOKEN"</pre></div>
        </div>
        <div class="endpoint">
            <h3>POST /pond/&lt;pond_id&gt;/event</h3>
            <div class="fields"><strong>Fields:</strong> fish_id, action ("add" or "remove"), count, date</div>
            <div class="curl"><pre>curl -X POST http://localhost:5000/pond/&lt;pond_id&gt;/event \
  -H "Authorization: Bearer ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{ "fish_id": "FISH123", "action": "add", "count": 10, "date": "2025-12-05" }'</pre></div>
        </div>
        <div class="endpoint">
            <h3>GET /pond/&lt;pond_id&gt;/events</h3>
            <div class="fields"><strong>Fields Returned:</strong> events: [event objects]</div>
            <div class="curl"><pre>curl -X GET http://localhost:5000/pond/&lt;pond_id&gt;/events \
  -H "Authorization: Bearer ACCESS_TOKEN"</pre></div>
        </div>
    </div>
    <div class="section">
        <h2>Messaging & Notification (Socket.io)</h2>
        <div class="endpoint">
            <h3>Connect with JWT token (access_token or refresh_token)</h3>
            <div class="fields"><strong>Fields:</strong> Authorization header: Bearer ACCESS_TOKEN or Bearer REFRESH_TOKEN</div>
            <div class="curl"><pre>const socket = io("http://localhost:5000", {
  extraHeaders: {
    Authorization: "Bearer ACCESS_TOKEN_OR_REFRESH_TOKEN"
  }
});</pre></div>
        </div>
        <div class="endpoint">
            <h3>Events</h3>
            <div class="fields"><strong>send_message:</strong> { to_user_key, message, from_user_key }<br><strong>broadcast_notification:</strong> { account_key, notification, from_user_key, user_keys? }<br><strong>receive_message, receive_notification:</strong> delivered to client</div>
        </div>
        <div class="note">All notifications/messages are persisted and delivered to online/offline users.</div>
    </div>
    <div class="section">
        <h2>Error Handling</h2>
        <div class="note">All APIs return <code>{ success: false, error: "..." }</code> for errors.<br>Auth required for protected endpoints (401 Unauthorized if missing/invalid).</div>
    </div>
</div>
</body>
</html>

